<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Leveo | Domine seu estoque sem planilhas</title>
  <meta name="description" content="Feito para perfumarias e lojas de cosm√©ticos. Alertas de ruptura, margem por produto e sugest√£o de reposi√ß√£o. Teste gratuito de 14 dias." />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-b from-gray-50 to-white text-gray-900">
  <header class="sticky top-0 z-30 bg-white/70 backdrop-blur border-b border-gray-100">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <div class="w-8 h-8 rounded-xl bg-black text-white grid place-items-center font-bold">L</div>
        <span class="font-semibold">Leveo</span>
      </div>
      <a id="duvidaTop" href="https://wa.me/5581992288619?text=Oi!%20Tenho%20uma%20d%C3%BAvida%20r%C3%A1pida."
         target="_blank" rel="noreferrer"
         class="px-4 py-2 text-sm rounded-xl border border-gray-300 hover:bg-gray-50">Tirar uma d√∫vida</a>
    </div>
  </header>

  <section class="max-w-5xl mx-auto px-4 pt-12 pb-6">
    <div class="grid md:grid-cols-2 gap-10 items-center">
      <div>
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-50 text-emerald-700 text-xs font-medium mb-4">
          <span>Teste Gr√°tis 14 dias</span>
          <span class="opacity-60">‚Ä¢ sem cart√£o de cr√©dito</span>
        </div>
        <h1 class="text-3xl md:text-5xl font-semibold leading-tight">
          Domine seu estoque em minutos ‚Äî <span class="underline decoration-emerald-400 decoration-4 underline-offset-4">sem planilhas</span>.
        </h1>
        <p class="mt-4 text-gray-600 text-lg">
          Veja o que comprar, o que est√° parado e onde seu lucro est√° escondido ‚Äî com suporte r√°pido via WhatsApp.
        </p>
        <ul class="mt-6 space-y-2 text-sm text-gray-700">
          <li>‚úÖ Feito para <strong>perfumarias independentes</strong></li>
          <li>‚úÖ Descubra o que gira e onde voc√™ perde margem</li>
          <li>‚úÖ Sem fric√ß√£o: cadastre 10 SKUs e veja resultado</li>
        </ul>
        <div class="mt-8 flex flex-col sm:flex-row gap-3">
          <a href="#form" class="px-5 py-3 rounded-2xl bg-black text-white font-medium hover:opacity-90 text-center">Pedir meu teste de 14 dias</a>
          <a id="duvidaMid" href="https://wa.me/5581992288619?text=Oi!%20Tenho%20uma%20d%C3%BAvida%20r%C3%A1pida."
             target="_blank" rel="noreferrer" class="px-5 py-3 rounded-2xl text-center text-gray-700 hover:bg-gray-50">Tenho uma d√∫vida</a>
        </div>
        <p class="mt-3 text-xs text-gray-500">*Seus dados est√£o seguros. Contato exclusivo sobre o teste.</p>
      </div>
      <div class="relative">
        <div class="rounded-3xl border bg-white p-6 shadow-sm">
          <div class="grid grid-cols-3 gap-3">
            <div><p class="text-xs text-gray-500">Ruptura</p><div class="h-2 bg-gray-200 rounded-full w-2/3"></div></div>
            <div><p class="text-xs text-gray-500">Margem m√©dia</p><div class="h-2 bg-gray-200 rounded-full w-1/2"></div></div>
            <div><p class="text-xs text-gray-500">Itens parados</p><div class="h-2 bg-gray-200 rounded-full w-1/3"></div></div>
          </div>
          <div class="mt-6 h-32 rounded-xl bg-gray-50 border grid place-items-center text-sm text-gray-500">
            Ilustra√ß√£o do dashboard
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="form" class="max-w-3xl mx-auto px-4 py-10">
    <div class="rounded-3xl border bg-white p-6 md:p-8 shadow-sm">
      <h2 class="text-2xl font-semibold">Receba seu acesso gratuito</h2>
      <p class="mt-1 text-gray-600">Preencha e nossa equipe entrar√° em contato pelo WhatsApp para liberar seu teste de 14 dias.</p>

      <form id="leadForm" class="mt-6 grid grid-cols-1 gap-4">
        <div>
          <label class="text-sm text-gray-700">Nome</label>
          <input id="nome" required class="mt-1 w-full rounded-xl border px-3 py-2 outline-none focus:ring-2 focus:ring-black" placeholder="Seu nome completo" />
        </div>
        <div>
          <label class="text-sm text-gray-700">WhatsApp (com DDD)</label>
          <input id="whatsapp" required inputmode="tel" class="mt-1 w-full rounded-xl border px-3 py-2 outline-none focus:ring-2 focus:ring-black" placeholder="(11) 9 9999-9999" />
        </div>
        <div>
          <label class="text-sm text-gray-700">Seu melhor e-mail (Opcional)</label>
          <input id="email" type="email" class="mt-1 w-full rounded-xl border px-3 py-2 outline-none focus:ring-2 focus:ring-black" placeholder="voce@exemplo.com" />
        </div>
        <button id="btn" class="mt-2 w-full px-5 py-3 rounded-2xl bg-black text-white font-medium hover:opacity-90">Quero meu acesso gr√°tis</button>
        <p class="text-xs text-gray-500">LGPD: usamos seus dados apenas para contato sobre o teste.</p>
      </form>

      <div id="ok" class="hidden text-center py-8">
        <div class="text-5xl mb-4">‚úÖ</div>
        <h3 class="text-xl font-semibold">Tudo certo!</h3>
        <p class="mt-2 text-gray-700">Vamos te chamar no WhatsApp em breve para liberar seu acesso.</p>
      </div>
    </div>
  </section>

  <script>
    const SUPABASE_FUNCTION_URL = "https://piewydyoisyfqndokzbn.functions.supabase.co/leads";
    const WHATSAPP = "5581992288619";
    const onlyDigits = s => (s||"").replace(/\D/g,"");

    document.getElementById("leadForm").addEventListener("submit", async (e)=>{
      e.preventDefault();
      const btn = document.getElementById("btn");
      btn.disabled = true; btn.textContent = "Enviando...";

      const nome = document.getElementById("nome").value.trim();
      const whatsapp = onlyDigits(document.getElementById("whatsapp").value);
      const email = document.getElementById("email").value.trim();

      if (nome.length < 2) { alert("Informe seu nome."); btn.disabled=false; btn.textContent="Quero meu acesso gr√°tis"; return; }
      if (whatsapp.length < 10) { alert("WhatsApp inv√°lido."); btn.disabled=false; btn.textContent="Quero meu acesso gr√°tis"; return; }

      try {
        await fetch(SUPABASE_FUNCTION_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ nome, whatsapp, email, utm: window.location.search || "" })
        });
      } catch(_) {}

      const msg = encodeURIComponent(`Oi! Quero participar do teste gratuito do Leveo. Meu nome √© ${nome}.`);
      window.open(`https://wa.me/${WHATSAPP}?text=${msg}`, "_blank", "noopener");

      document.getElementById("leadForm").classList.add("hidden");
      document.getElementById("ok").classList.remove("hidden");
      btn.disabled=false; btn.textContent="Quero meu acesso gr√°tis";
    });
<script>
  // === CONFIG ===
  const SUPABASE_FUNCTION_URL = "https://piewydyoisyfqndokzbn.functions.supabase.co/leads"; // sua Edge Function
  const WHATSAPP = "5581992288619"; // seu n√∫mero

  // Helpers
  const onlyDigits = s => (s || "").replace(/\D/g, "");
  const getUTM = () => Object.fromEntries(new URLSearchParams(location.search));

  // Gera uma chave idempotente (√∫nica) por envio
  function makeIdempotencyKey(whatsapp) {
    try { return crypto.randomUUID(); } catch { return (onlyDigits(whatsapp) || "anon") + "-" + Date.now(); }
  }

  const form = document.getElementById("leadForm");
  if (form) {
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const btn = document.getElementById("btn");
      const nome = (document.getElementById("nome")?.value || "").trim();
      const whatsapp = onlyDigits(document.getElementById("whatsapp")?.value || "");
      const email = (document.getElementById("email")?.value || "").trim();

      if (nome.length < 2) { alert("Informe seu nome."); return; }
      if (whatsapp.length < 10) { alert("WhatsApp com DDD inv√°lido."); return; }

      btn.disabled = true; btn.textContent = "Enviando...";

      const idemKey = makeIdempotencyKey(whatsapp);
      const payload = {
        nome, whatsapp, email,
        utm: getUTM(),
        page_url: location.href,
        referrer: document.referrer || ""
      };

      try {
        await fetch(SUPABASE_FUNCTION_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            // üëâ Header que sua fun√ß√£o exige:
            "X-Idempotency-Key": idemKey
          },
          body: JSON.stringify(payload)
        });
      } catch (_) {
        // n√£o quebra a UX se falhar
      }

      // Abre seu WhatsApp
      const texto = encodeURIComponent(`Oi! Quero participar do teste gratuito do Leveo. Meu nome √© ${nome}.`);
      window.open(`https://wa.me/${WHATSAPP}?text=${texto}`, "_blank", "noopener");

      // Feedback visual
      document.getElementById("leadForm")?.classList.add("hidden");
      document.getElementById("ok")?.classList.remove("hidden");

      btn.disabled = false; btn.textContent = "Quero meu acesso gr√°tis";
    });
  }
</script>

</body>
</html>
